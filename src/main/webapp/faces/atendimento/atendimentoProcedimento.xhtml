<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/faces/index.xhtml"                
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"                
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:comps="http://xmlns.jcp.org/jsf/composite/comps">

    <ui:define name="context">                   

        <style>
            .ui-panelgrid .ui-panelgrid-cell{border-width:0px;border-style:none;border-color:inherit;padding:0px 0px;display: flex;}
        </style>

        <h:outputText id="page-rule" rendered="#{menuBean.isRule('atendimento')}"/>

        <h:body onload="#{odontogramaBean.loadInfoAtendimentoProcedimento()}">

            <div class="page-title">Atendimento</div>

            <p:panel id="panel-odonto-atendimento" header="#{field.parametrodepesquisa}" toggleable="true" toggleSpeed="500">

                <h:form id="panel-odonto-atendimento-form">

                    <h:panelGrid columns="4" cellspacing="10">

                        <h:outputText id="panel-orcamento-form-ot-data" value="Paciente" class="text-bold"/>
                        <h:outputText id="panel-orcamento-form-ot-data-value" 
                                      value="#{odontogramaBean.tbatendimento.idagendamento.idcliente.nmcliente}"/>

                        <h:outputText id="panel-orcamento-form-ot-dtnascimento" value="Data nascimento" class="text-bold"/>
                        <h:outputText id="panel-orcamento-form-ot-dtnascimento-value" 
                                      value="#{odontogramaBean.tbatendimento.idagendamento.idcliente.dtnascimento}">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <h:outputText id="panel-orcamento-form-ot-cliente" value="Data agendamento" class="text-bold"/>
                        <h:outputText id="panel-orcamento-form-ot-cliente-value" 
                                      value="#{odontogramaBean.tbatendimento.idagendamento.tmdataagendamento}">
                            <f:convertDateTime pattern="dd/MM/yyyy HH:mm" timeZone="GMT-04:00"/>
                        </h:outputText>

                        <h:outputText id="panel-orcamento-form-ot-funcionario" value="Consulta" class="text-bold"/>
                        <h:outputText id="panel-orcamento-form-ot-funcionario-value"
                                      value="#{odontogramaBean.tbatendimento.idagendamento.intipo == 0 ? 'Agendamento':'Orçamento'}"/>

                        <h:outputText id="panel-orcamento-form-ot-orcamento" value="Nr. orçamento" class="text-bold"
                                      rendered="false"/>
                        <h:outputText id="panel-orcamento-form-ot-orcamento-value"
                                      value="#{odontogramaBean.tborcamento.idorcamento}"
                                      rendered="false"/>

                        <h:outputText id="panel-orcamento-form-ot-status-orcamento" value="Status orçamento" class="text-bold"
                                      rendered="false"/>
                        <h:outputText id="panel-orcamento-form-ot-status-orcamento-value"
                                      value="#{odontogramaBean.tborcamento.idtipostatusorcamento.nmtipostatusorcamento}"
                                      rendered="false"/>

                    </h:panelGrid>

                    <div class="space"/>

                    <p:commandButton id="fechar-atendimento" value="Finalizar atendimento" icon="ui-icon-close"
                                     onclick="PF('fimAtendimento').show();"/>                    

                    <p:commandButton id="voltar-list-atendimento" value="#{field.cancelar}"
                                     action="atendimentoListTest.xhtml" immediate="true"
                                     onclick="PF('statusDialog').show();" icon="ui-icon-cancel"/>

                    <div class="space"/>

                    <p:tabView id="tabView-procedimentos">
                        <p:tab id="prontuario" title="Prontuario">

                            <h:outputLabel value="Históricos e Informações do Paciente" class="text-bold"/>
                            
                            <f:verbatim>
                                <br/><br/>
                            </f:verbatim>                            

                            <h:outputLink
                                value="../atendimento/consultaReceituarioOdontologico.jsf"
                                target="_blank">
                                <h:outputText value="Histórico de Receituário"/>
                            </h:outputLink>
                            <f:verbatim>
                                <br/>
                            </f:verbatim>
                            <h:outputLink
                                value="../atendimento/consultasOrcamento.jsf"
                                target="_blank">
                                <h:outputText value="Histórico de Orçamento"/>
                            </h:outputLink>
                            <f:verbatim>
                                <br/>
                            </f:verbatim>
                            <h:outputLink
                                value="../atendimento/consultasOdontologicas.jsf"
                                target="_blank">
                                <h:outputText value="Últimas Consultas"/>
                            </h:outputLink>
                            <f:verbatim>
                                <br/>
                            </f:verbatim>
                            <h:outputLink
                                value="../atendimento/consultasQueixaPaciente.jsf"
                                target="_blank">
                                <h:outputText value="Diagnósticos"/>
                            </h:outputLink>
                        </p:tab>
                        <p:tab id="lista-procedimentos" title="Lista de Procedimento">

                            <p:commandButton id="button-inicia-atendimento" value="Iniciar procedimento"
                                             ajax="false" icon="ui-icon-play" action="#{odontogramaBean.iniciarProcedimentoAtendimento()}"
                                             onclick="PF('statusDialog').show();"
                                             oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"/>
                            <p:spacer/>

                            <p:commandButton id="button-fecha-atendimento" value="Finalizar procedimento"
                                             ajax="false" icon="ui-icon-stop" action="#{odontogramaBean.finalizarProcedimentoAtendimento()}"
                                             onclick="PF('statusDialog').show();"
                                             oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"/>
                            <p:spacer/>

                            <p:commandButton id="button-cancela-atendimento" value="Cancelar procedimento"
                                             ajax="false" icon="ui-icon-cancel" action="#{odontogramaBean.cancelarProcedimentoAtendimento()}"
                                             onclick="PF('statusDialog').show();"
                                             oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"/>

                            <h:panelGrid columns="12" cellspacing="10">

                                <p:graphicImage value="#{resource['/images/status/bloqueado.gif']}"
                                                title="Não Realizado"/>
                                <h:outputText value="Não Realizado" class="text-bold"/>

                                <p:graphicImage value="#{resource['/images/status/emtratamento.gif']}"
                                                title="Em Tratamento"/>
                                <h:outputText value="Em Tratamento" class="text-bold"/>

                                <p:graphicImage value="#{resource['/images/status/liberado.gif']}" title="Realizado"/>
                                <h:outputText value="Realizado" class="text-bold"/>

                                <p:graphicImage value="#{resource['/images/status/semibloqueado.gif']}"
                                                title="Cancelados"/>
                                <h:outputText value="Cancelados" class="text-bold"/>

                                <p:graphicImage value="#{resource['/images/status/atendido.gif']}" title="Não Lançados"/>
                                <h:outputText value="Não Lançados" class="text-bold"/>

                                <p:graphicImage value="#{resource['/images/status/faltoso.gif']}" title="Removidos"/>
                                <h:outputText value="Removidos" class="text-bold"/>

                            </h:panelGrid>

                            <p:dataTable id="dataTable-procedimentos" value="#{odontogramaBean.listTbprocedimentosGeral}" 
                                         var="procedimentosGeral" 
                                         widgetVar="procedimentosGerais"
                                         paginator="true" paginatorPosition="bottom"
                                         selection="#{odontogramaBean.tbprocedimentoSelected}"
                                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rowsPerPageTemplate="10,15,20" emptyMessage="#{message.nenhumresultadoencontrado}"
                                         rowIndexVar="index" rowKey="#{procedimentosGeral.idprocedimento}" 
                                         disabledSelection="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 6 
                                                              or procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 1
                                                              or procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 4
                                                              or procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 5}">

                                <p:column selectionMode="single" style="width:32px;text-align: center"/>

                                <p:column headerText="#{field.status}" style="width:32px;text-align: center">
                                    <p:graphicImage id="naorealizado" value="#{resource['images/status/bloqueado.gif']}" 
                                                    title="Não Realizado"
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 0}"/>

                                    <p:graphicImage id="presente" value="#{resource['images/status/emtratamento.gif']}" 
                                                    title="Em Tratamento"
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 2}"/>

                                    <p:graphicImage id="realizados" value="#{resource['images/status/liberado.gif']}" 
                                                    title="Realizados" 
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 1}"/>

                                    <p:graphicImage id="cancelados" value="#{resource['images/status/semibloqueado.gif']}" 
                                                    title="Cancelados"
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 5}"/>

                                    <p:graphicImage id="naolancados" value="#{resource['images/status/atendido.gif']}" 
                                                    title="Não Lançados"
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 4}"/>                                   

                                    <p:graphicImage id="removidos" value="#{resource['images/status/faltoso.gif']}" 
                                                    title="Removidos"
                                                    rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 6}"/>
                                </p:column>                               

                                <p:column headerText="Dente">
                                    <h:outputText value="#{procedimentosGeral.iddente.nrposicao}"/>
                                </p:column>

                                <p:column headerText="Procedimento">
                                    <h:outputText value="#{procedimentosGeral.idservico.nmservico}"/>
                                </p:column>

                                <p:column headerText="Face">
                                    <h:outputText value="#{procedimentosGeral.iddente.nmdente}"/>
                                </p:column>

                                <p:column headerText="Quantidade">
                                    <h:outputText value="#{procedimentosGeral.qtprocedimento}"/>
                                </p:column>                               

                                <p:column headerText="Servico" rendered="false">
                                    <h:outputText value="#{procedimentosGeral.insituacao}"/>
                                </p:column>

                                <p:column headerText="Profissional">
                                    <h:outputText value="#{procedimentosGeral.idorcamento.idagendamento.idfuncionario.nmfuncionario}"/>
                                </p:column>

                                <p:column style="width:32px;text-align: center">
                                    <p:commandLink rendered="#{procedimentosGeral.idtipostatusprocedimento.intipostatusprocedimento == 4}">
                                        <p:graphicImage value="#{resource['images/delete.gif']}" onclick="PF('confirmation').show();"/>
                                        <f:setPropertyActionListener value="#{procedimentosGeral}" target="#{odontogramaBean.tbprocedimentoToRemove}"/>
                                    </p:commandLink>
                                </p:column>

                            </p:dataTable>

                            <div class="space"/>

                            <p:commandButton value="#{field.adicionar}" icon="ui-icon-plusthick" 
                                             onclick="PF('procedimentoDialog').show();"/>                           

                            <p:confirmDialog id="confirmDialog" message="deseja deletar este procedimento ?"
                                             header="tela para excluir procedimento" severity="alert" widgetVar="confirmation">  

                                <p:commandButton id="confirm" value="#{field.sim}" ajax="false"
                                                 update=":panel-odonto-atendimento-form,:messages"
                                                 action="#{odontogramaBean.removeProcedimentoAtendimento()}"
                                                 oncomplete="PF('confirmation').hide();PF('procedimentosGerais').update();"/>  
                                <p:commandButton id="decline" value="#{field.nao}" onclick="PF('confirmation').hide();" 
                                                 type="button" />   
                            </p:confirmDialog>
                        </p:tab>
                        <p:tab id="odontograma" title="Odontograma">
                            <h:panelGrid columns="4" cellspacing="10">

                                <h:outputText value="Especialidade" class="text-bold"/>
                                <p:selectOneMenu value="#{odontogramaBean.tbsubespecialidade}" converter="converterEntity"
                                                 filter="true" filterMatchMode="contains">
                                    <f:selectItem itemLabel="Selecione um especialidade."/>
                                    <f:selectItems value="#{odontogramaBean.listTbsubespecialidades}" var="subespecialidade"
                                                   itemValue="#{subespecialidade}" itemLabel="#{subespecialidade.nmsubespecialidade}"/>
                                    <p:ajax event="change" listener="#{odontogramaBean.atualizaListaTbServicos()}"
                                            update="servicos"/>
                                </p:selectOneMenu>                                    

                                <h:outputText value="Procedimento" class="text-bold"/>
                                <p:selectOneMenu id="servicos" value="#{odontogramaBean.tbservico}" converter="converterEntity"
                                                 filter="true" filterMatchMode="contains">
                                    <f:selectItem itemLabel="Selecione um procedimento."/>
                                    <f:selectItems value="#{odontogramaBean.listTbservicos}" var="servico"
                                                   itemValue="#{servico}" itemLabel="#{servico.nmservico}"/>
                                </p:selectOneMenu>

                            </h:panelGrid>

                            <p:tabView id="odontogramaAdultoInfantil">
                                <p:tab id="odontogramaAdulto" title="Adulto">                                                                        
                                    <h:panelGrid id="panelGridOdontogramaAdulto" columns="1">                                         
                                        <table id="table" border="0">                                            
                                            <tr id="tableLinha" style="border: 0px;">
                                                <ui:repeat value="#{odontogramaBean.listDentesSuperiores}" var="dente"
                                                           id="superior">
                                                    <td>
                                                        <p:panelGrid>
                                                            <tr>
                                                                <p:column>
                                                                    <h:outputText value="#{dente.nrDente}" class="text-bold"/>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="raiz_superior#{dente.nrDente}" value="#{dente.listFacesDente.get(0).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(0).nmFace}"/>                                            
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(0).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="0" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>                                                            
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="cervical#{dente.nrDente}" value="#{dente.listFacesDente.get(1).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(1).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(1).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="1" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="vestibular#{dente.nrDente}" value="#{dente.listFacesDente.get(2).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(2).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(2).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="2" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column colspan="3" class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="distal#{dente.nrDente}" value="#{dente.listFacesDente.get(3).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(3).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(3).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="3" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="oclusal#{dente.nrDente}" value="#{dente.listFacesDente.get(4).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(4).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(4).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="4" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="mesial#{dente.nrDente}" value="#{dente.listFacesDente.get(5).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(5).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(5).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="5" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr> 
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="palatina#{dente.nrDente}" value="#{dente.listFacesDente.get(6).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(6).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                        </p:panelGrid>
                                                    </td>                                                    
                                                </ui:repeat>
                                            </tr>
                                            <tr>
                                                <ui:repeat id="inferior" value="#{odontogramaBean.listDentesInferiores}" var="denteInferior">
                                                    <td>
                                                        <p:panelGrid>
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="raiz_superior#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(0).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(0).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column colspan="3" class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="distal#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(1).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(1).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(1).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="1" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="oclusal#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(2).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(2).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(2).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="2" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="mesial#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(3).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(3).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(3).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="3" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="cervical#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(4).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(4).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(4).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="4" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="vestibular#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(5).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(5).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(5).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="5" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="palatina#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(6).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(6).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <h:outputText value="#{denteInferior.nrDente}" class="text-bold"/>
                                                                </p:column>
                                                            </tr>
                                                        </p:panelGrid>                                    
                                                    </td>                                
                                                </ui:repeat>
                                            </tr>
                                        </table>
                                    </h:panelGrid>
                                </p:tab>
                                <p:tab id="odontogramaInfantil" title="Infantil">
                                    <h:panelGrid id="panelGridOdontogramaInfantil" columns="1">
                                        <table id="tableInfantil">                        
                                            <tr>
                                                <ui:repeat value="#{odontogramaBean.listDentesSuperioresInfantil}" var="dente"
                                                           id="superiorInfantil">
                                                    <td>
                                                        <p:panelGrid>
                                                            <tr>
                                                                <p:column>
                                                                    <h:outputText value="#{dente.nrDente}" class="text-bold"/>
                                                                </p:column>
                                                            </tr>                                       
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="raiz_superior#{dente.nrDente}" value="#{dente.listFacesDente.get(0).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(0).nmFace}"/>                                            
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(0).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="0" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="cervical#{dente.nrDente}" value="#{dente.listFacesDente.get(1).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(1).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(1).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="1" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>                                         
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="vestibular#{dente.nrDente}" value="#{dente.listFacesDente.get(2).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(2).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(2).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="2" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column colspan="3" class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="distal#{dente.nrDente}" value="#{dente.listFacesDente.get(3).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(3).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(3).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="3" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="oclusal#{dente.nrDente}" value="#{dente.listFacesDente.get(4).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(4).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(4).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="4" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="mesial#{dente.nrDente}" value="#{dente.listFacesDente.get(5).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(5).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(5).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="5" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="palatina#{dente.nrDente}" value="#{dente.listFacesDente.get(6).urlImageFace}"
                                                                                        title="#{dente.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{dente.nrDente}" target="#{odontogramaBean.denteSelected}"/>
                                                                        <f:setPropertyActionListener value="#{dente.listFacesDente.get(6).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                        </p:panelGrid>                                    
                                                    </td>                                
                                                </ui:repeat>
                                            </tr>
                                            <tr>
                                                <ui:repeat id="inferiorInfantil" value="#{odontogramaBean.listDentesInferioresInfantil}" 
                                                           var="denteInferior">
                                                    <td>
                                                        <p:panelGrid>                                        
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="raiz_superior#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(0).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(0).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column colspan="3" class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="distal#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(1).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(1).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(1).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="1" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="oclusal#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(2).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(2).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(2).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="2" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="mesial#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(3).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(3).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(3).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="3" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column class="linha">
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true" class="linha">
                                                                        <p:graphicImage id="cervical#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(4).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(4).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(4).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="4" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="vestibular#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(5).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(5).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(5).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="5" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <p:commandLink update=":dialogOdontograma" oncomplete="PF('odontogramaDialog').show();"
                                                                                   action="#{odontogramaBean.loadProcedimentosPorDente()}"
                                                                                   async="true">
                                                                        <p:graphicImage id="palatina#{denteInferior.nrDente}" value="#{denteInferior.listFacesDente.get(6).urlImageFace}"
                                                                                        title="#{denteInferior.listFacesDente.get(6).nmFace}"/>
                                                                        <f:setPropertyActionListener value="#{denteInferior.nrDente}" target="#{odontogramaBean.denteSelected}"/>                                            
                                                                        <f:setPropertyActionListener value="#{denteInferior.listFacesDente.get(6).nrFace}" target="#{odontogramaBean.faceSelected}"/>
                                                                        <f:setPropertyActionListener value="6" target="#{odontogramaBean.posicao}"/>
                                                                    </p:commandLink>
                                                                </p:column>
                                                            </tr>
                                                            <tr>
                                                                <p:column>
                                                                    <h:outputText value="#{denteInferior.nrDente}" class="text-bold"/>
                                                                </p:column>
                                                            </tr>
                                                        </p:panelGrid>                                    
                                                    </td>                                
                                                </ui:repeat>
                                            </tr>
                                        </table>
                                    </h:panelGrid>
                                </p:tab>
                            </p:tabView>
                        </p:tab>                       
                    </p:tabView>

                    <p:confirmDialog id="confirmDialogFimAtendimento" message="Deseja finalizar este atendimento ?"
                                     header="Tela para finalizar atendimento" severity="alert" widgetVar="fimAtendimento">  

                        <h:panelGrid columns="2">
                            <comps:outputLabel id="panel-add-cliente-pg-ot-referencia" value="#{field.observacao}" required="true"/>
                            <p:inputTextarea id="panel-add-cliente-pg-it-referencia" value="#{odontogramaBean.tbatendimento.idagendamento.idcliente.observacao}"
                                             autoResize="true" cols="60"/>
                        </h:panelGrid>

                        <p:commandButton id="confirm" value="#{field.sim}" ajax="false"                                    
                                         action="#{odontogramaBean.finalizarAtendimento(true)}"
                                         oncomplete="PF('fimAtendimento').hide(); PF('statusDialog').hide();" icon="ui-icon-check"
                                         onclick="PF('statusDialog').show();"/>  
                        <p:commandButton id="decline" value="#{field.nao}" onclick="PF('fimAtendimento').hide();" 
                                         type="button" icon="ui-icon-close"/>   
                    </p:confirmDialog>

                </h:form>               

                <p:dialog id="dialogProcedimento" header="Incluir procedimento" widgetVar="procedimentoDialog" 
                          showEffect="fade" hideEffect="fade" resizable="true" modal="true">                       
                    <h:form>
                        <h:panelGrid id="dialogProcedimento-pg" columns="2" 
                                     cellspacing="10">

                            <comps:outputLabel id="dialogAgendamento-pg-ot-servico" value="Procedimento" required="true"/>
                            <p:selectOneMenu id="dialogAgendamento-pg-som-servico-value" value="#{odontogramaBean.tbservicoManual}"
                                             converter="converterEntity" filter="true"
                                             filterMatchMode="contains" required="true"
                                             requiredMessage="Procedimento é um campo obrigatório">                           
                                <p:ajax event="change" process="@this"/>    
                                <f:selectItem itemLabel="Selecione um procedimento. "/>                                
                                <f:selectItems value="#{odontogramaBean.listTbservicos}" var="servico"
                                               itemValue="#{servico}" itemLabel="#{servico.nmservico}"/>
                            </p:selectOneMenu>

                            <comps:outputLabel id="dialogAgendamento-pg-ot-dente" value="Dente" required="true"/>
                            <p:selectOneMenu id="dialogAgendamento-pg-ot-dente-value" converter="converterEntity"
                                             value="#{odontogramaBean.tbdente}" filter="true"
                                             filterMatchMode="contains" required="true"
                                             requiredMessage="Dente é um campo obrigatório">
                                <p:ajax event="change" process="@this"/>
                                <f:selectItem itemLabel="Selecione um dente. "/> 
                                <f:selectItems value="#{odontogramaBean.listTbdentes}" var="dente"
                                               itemValue="#{dente}" itemLabel="#{dente.nrposicao}"/>
                            </p:selectOneMenu>

                            <comps:outputLabel id="dialogAgendamento-pg-ot-face" value="Face" required="true"/>
                            <p:selectOneMenu id="dialogAgendamento-pg-ot-face-value" value="#{odontogramaBean.inFace}"
                                             filter="true" filterMatchMode="contains"
                                             required="true" requiredMessage="Face é uma campo obrigatório">
                                <p:ajax event="change" process="@this"/>
                                <f:selectItem itemLabel="Selecione uma face. "/> 
                                <f:selectItems value="#{odontogramaBean.listFacesDentes}"/>
                            </p:selectOneMenu>

                            <comps:outputLabel value="Quantidade" required="true"/>
                            <p:inputText value="#{odontogramaBean.qtProcedimento}" required="true"
                                         requiredMessage="Quantidade precisa ser maior ou igual a (1)."/>                           

                        </h:panelGrid>


                        <p:commandButton id="confirmDialog-button" value="#{field.salvar}"
                                         update=":panel-odonto-atendimento-form,:messages" ajax="false"
                                         action="#{odontogramaBean.criarProcedimentoManualAtendimento()}"
                                         oncomplete="PF('procedimentoDialog').hide(), PF('statusDialog').hide();
                                         PF('procedimentosGerais').update();"
                                         icon="ui-icon-check" onclick="PF('statusDialog').show();"/>  

                        <p:commandButton id="declineDialog-button" value="#{field.cancelar}" 
                                         onclick="PF('procedimentoDialog').hide();" type="button" 
                                         icon="ui-icon-close"/>
                    </h:form>                                                

                </p:dialog>

                <p:dialog id="dialogOdontograma" header="Tela de procedimentos por dente" widgetVar="odontogramaDialog" 
                          showEffect="fade" hideEffect="fade" resizable="true" modal="true" width="800px">                       

                    <h:form>

                        <h:outputText value="Nenhum procedimento adicionado para o dente #{odontogramaBean.denteSelected} face #{odontogramaBean.nmFaceSelected}" 
                                      class="text-bold" rendered="#{empty odontogramaBean.listTbprocedimentosPorDente}"/>

                        <h:panelGrid columns="12" cellspacing="10" 
                                     rendered="#{not empty odontogramaBean.listTbprocedimentosPorDente}">

                            <p:graphicImage value="#{resource['/images/status/bloqueado.gif']}"
                                            title="Não Realizado"/>
                            <h:outputText value="Não Realizado" class="text-bold"/>

                            <p:graphicImage value="#{resource['/images/status/emtratamento.gif']}"
                                            title="Em Tratamento"/>
                            <h:outputText value="Em Tratamento" class="text-bold"/>

                            <p:graphicImage value="#{resource['/images/status/liberado.gif']}" title="Realizado"/>
                            <h:outputText value="Realizado" class="text-bold"/>

                            <p:graphicImage value="#{resource['/images/status/semibloqueado.gif']}"
                                            title="Cancelados"/>
                            <h:outputText value="Cancelados" class="text-bold"/>

                            <p:graphicImage value="#{resource['/images/status/atendido.gif']}" title="Não Lançados"/>
                            <h:outputText value="Não Lançados" class="text-bold"/>

                            <p:graphicImage value="#{resource['/images/status/faltoso.gif']}" title="Removidos"/>
                            <h:outputText value="Removidos" class="text-bold"/>

                        </h:panelGrid>

                        <p:dataTable id="dataTable-procedimentos" value="#{odontogramaBean.listTbprocedimentosPorDente}" var="procedimentos" 
                                     widgetVar="procedimentosDente"
                                     paginator="true" paginatorPosition="bottom" selection="#{odontogramaBean.tbprocedimentoSelected}"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="10,15,20" emptyMessage="#{message.nenhumresultadoencontrado}"
                                     rowIndexVar="index" rowKey="#{procedimentos.idprocedimento}" 
                                     disabledSelection="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 6 
                                                          or procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 1
                                                          or procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 4
                                                          or procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 5}"
                                     rendered="#{not empty odontogramaBean.listTbprocedimentosPorDente}">

                            <p:column selectionMode="single" style="width:32px;text-align: center"/>

                            <p:column headerText="#{field.status}" style="width:32px;text-align: center">
                                <p:graphicImage id="naorealizado" value="#{resource['images/status/bloqueado.gif']}" 
                                                title="Não Realizado"
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 0}"/>

                                <p:graphicImage id="presente" value="#{resource['images/status/emtratamento.gif']}" 
                                                title="Em Tratamento"
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 2}"/>

                                <p:graphicImage id="realizados" value="#{resource['images/status/liberado.gif']}" 
                                                title="Realizados" 
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 1}"/>

                                <p:graphicImage id="cancelados" value="#{resource['images/status/semibloqueado.gif']}" 
                                                title="Cancelados"
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 5}"/>

                                <p:graphicImage id="naolancados" value="#{resource['images/status/atendido.gif']}" 
                                                title="Não Lançados"
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 4}"/>                                   

                                <p:graphicImage id="removidos" value="#{resource['images/status/faltoso.gif']}" 
                                                title="Removidos"
                                                rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 6}"/>
                            </p:column>                               

                            <p:column headerText="Dente">
                                <h:outputText value="#{procedimentos.iddente.nrposicao}"/>
                            </p:column>

                            <p:column headerText="Procedimento">
                                <h:outputText value="#{procedimentos.idservico.nmservico}"/>
                            </p:column>

                            <p:column headerText="Face">
                                <h:outputText value="#{procedimentos.iddente.nmdente}"/>
                            </p:column>

                            <p:column headerText="Quantidade">
                                <h:outputText value="#{procedimentos.qtprocedimento}"/>
                            </p:column>                               

                            <p:column headerText="Servico" rendered="false">
                                <h:outputText value="#{procedimentos.insituacao}"/>
                            </p:column>

                            <p:column style="width:32px;text-align: center">
                                <p:commandLink action="#{odontogramaBean.removeProcedimentoAtendimento()}" ajax="false"
                                               oncomplete="PF('procedimentosGerais').update();PF('procedimentosDente').update();"
                                               rendered="#{procedimentos.idtipostatusprocedimento.intipostatusprocedimento == 4}">
                                    <p:graphicImage value="#{resource['images/delete.gif']}"/>
                                    <f:setPropertyActionListener value="#{procedimentos}" target="#{odontogramaBean.tbprocedimentoToRemove}"/>
                                </p:commandLink>
                            </p:column>

                        </p:dataTable>

                        <div class="space"/>

                        <p:commandButton id="confirmDialog-button" value="#{field.salvar}"
                                         update=":messages" ajax="false"
                                         action="#{odontogramaBean.adicionarProcedimentoOdontogramaAtendimento()}"
                                         oncomplete="PF('odontogramaDialog').hide();PF('procedimentosGerais').update();"
                                         icon="ui-icon-check">
                            <f:param name="nrDente" value="#{odontogramaBean.denteSelected}"/>                            
                            <f:param name="nrFace" value="#{odontogramaBean.faceSelected}"/>
                            <f:param name="nrPosicao" value="#{odontogramaBean.posicao}"/>
                            <f:param name="idServico" value="#{odontogramaBean.tbservico.idservico}"/>
                        </p:commandButton>  

                        <p:commandButton id="declineDialog-button" value="#{field.cancelar}" 
                                         onclick="PF('odontogramaDialog'

                                                         ).hide();" type="button" 
                                         icon="ui-icon-close"/>

                        <p:commandButton id="button-inicia-atendimento-dialog" value="Iniciar procedimento"
                                         ajax="false" icon="ui-icon-play" action="#{odontogramaBean.iniciarProcedimentoAtendimento()}"
                                         onclick="PF('statusDialog'

                                                         ).show();"
                                         oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"
                                         rendered="#{not empty odontogramaBean.listTbprocedimentosPorDente}"/>
                        <p:spacer/>

                        <p:commandButton id="button-fecha-atendimento-dialog" value="Finalizar procedimento"
                                         ajax="false" icon="ui-icon-stop" action="#{odontogramaBean.finalizarProcedimentoAtendimento()}"
                                         onclick="PF('statusDialog'

                                                         ).show();"
                                         oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"
                                         rendered="#{not empty odontogramaBean.listTbprocedimentosPorDente}"/>
                        <p:spacer/>

                        <p:commandButton id="button-cancela-atendimento-dialog" value="Cancelar procedimento"
                                         ajax="false" icon="ui-icon-cancel" action="#{odontogramaBean.cancelarProcedimentoAtendimento()}"
                                         onclick="PF('statusDialog'

                                                         ).show();"
                                         oncomplete="PF('statusDialog').hide();PF('procedimentosGerais').update();"
                                         rendered="#{not empty odontogramaBean.listTbprocedimentosPorDente}"/>
                    </h:form>

                </p:dialog>

            </p:panel>          

        </h:body>

    </ui:define>

</ui:composition>

